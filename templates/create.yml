---

- hosts: localhost

  vars:

  tasks:
    - name: Create target directory.
      file:
        path: "/home/ce-dev/.ce-dev-cache/{{ project_name }}/ce-dev/ansible"
        state: directory
        recurse: yes    
    - name: Init git repo.
      command: git init
      args:
        chdir: "/home/ce-dev/.ce-dev-cache/{{ project_name }}"
    - name: Generate docker-compose template.
      template:
        src: "{{ project_type }}/ce-dev/ce-dev.compose.yml"
        dest: "/home/ce-dev/.ce-dev-cache/{{ project_name }}/ce-dev/ce-dev.compose.yml"
    - name: Generate docker-compose prebuilt template.
      template:
        src: "{{ project_type }}/ce-dev/ce-dev.compose.prebuilt.yml"
        dest: "/home/ce-dev/.ce-dev-cache/{{ project_name }}/ce-dev/ce-dev.compose.prebuilt.yml"
    - name: Generate provision playbook.
      template:
        src: "{{ project_type }}/ce-dev/ansible/provision.yml"
        dest: "/home/ce-dev/.ce-dev-cache/{{ project_name }}/ce-dev/ansible/provision.yml"
    - name: Generate deploy playbook.
      template:
        src: "{{ project_type }}/ce-dev/ansible/deploy.yml"
        dest: "/home/ce-dev/.ce-dev-cache/{{ project_name }}/ce-dev/ansible/deploy.yml"
    - name: Generate deploy playbook.
      template:
        src: "{{ project_type }}/ce-dev/ansible/deploy.yml"
        dest: "/home/ce-dev/.ce-dev-cache/{{ project_name }}/ce-dev/ansible/deploy.yml"
    - name: Generate project gitignore file.
      template:
        src: "{{ project_type }}/gitignore.j2"
        dest: "/home/ce-dev/.ce-dev-cache/{{ project_name }}/.gitignore"
    - name: Generate ce-dev gitignore file.
      template:
        src: "gitignore.j2"
        dest: "/home/ce-dev/.ce-dev-cache/{{ project_name }}/ce-dev/.gitignore"